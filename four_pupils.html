<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Four Pupils</title>
</head>
<body>
<table border="1">
  <thead>
    <tr>
      <th>User</th>
      <th>Codeforces Rating</th>
    </tr>
  </thead>
  <tbody id="ratingTableBody">
    <!-- Table rows will be dynamically added here -->
  </tbody>
</table>

<script>
  // Function to fetch Codeforces ratings
  function getRating(handle) {
    return new Promise((resolve, reject) => {
      fetch(`https://codeforces.com/api/user.info?handles=${handle}`)
        .then(response => {
          if (!response.ok) {
            throw new Error('Network response was not ok');
          }
          return response.json();
        })
        .then(data => {
          if (data.status === 'OK' && data.result.length > 0) {
            const user = data.result[0];
            const rating = user.rating || 'Unrated'; // If rating is not available, show as Unrated
            resolve({ name: handle, rating: rating }); // Resolve with an object containing name and rating
          } else {
            reject(new Error('User not found or API error'));
          }
        })
        .catch(error => {
          reject(error);
        });
    });
  }

  // Users and their Codeforces handles
  const users = [
    { name: 'Emmanuel', handle: 'OsazuwaEmmanuel' },
    { name: 'Genesis', handle: 'daveshub' },
    { name: 'Minerva', handle: 'Minerva2005' },
    { name: 'Turing_apple', handle: 'Turing_apple'},
    { name: 'python_tamer', handle: 'python_tamer'},
    { name: 'cyberdude', handle: 'cyberdude'},
    { name: 'cryptickid91', handle: 'cryptickid91'}
    // Add more users as needed
  ];

  // Populate the table with ratings
  async function populateTable() {
    const tableBody = document.getElementById('ratingTableBody');
    const ratingPromises = users.map(user => getRating(user.handle));

    Promise.all(ratingPromises)
      .then(ratings => {
        // Sort users based on ratings in descending order
        const sortedUsers = users.sort((a, b) => {
          const ratingA = ratings.find(rating => rating.name === a.handle).rating;
          const ratingB = ratings.find(rating => rating.name === b.handle).rating;
          return ratingB - ratingA;
        });

        // Populate the table with sorted users
        sortedUsers.forEach(user => {
          const rating = ratings.find(rating => rating.name === user.handle).rating;
          const row = `<tr><td>${user.name}</td><td>${rating}</td></tr>`;
          tableBody.insertAdjacentHTML('beforeend', row);
        });
      })
      .catch(error => {
        console.error('Error fetching ratings:', error);
        const row = `<tr><td colspan="2">Error fetching ratings</td></tr>`;
        tableBody.insertAdjacentHTML('beforeend', row);
      });
  }

  // Call the populateTable function when the page loads
  window.onload = populateTable;
</script>
</body>
</html>
